<script src="~/lib/docxtemplater/build/docxtemplater-latest.min.js" type="text/javascript"></script>
<script src="~/lib/jszip/dist/jszip.min.js" type="text/javascript"></script>
<script src="~/lib/jszip-utils/dist/jszip-utils.min.js" type="text/javascript"></script>
<script src="~/lib/file-saver/FileSaver.min.js" type="text/javascript"></script>

<script>


    var data = {
        "items": [{
            "ach": "الصيدلية المركزية التونسية",
            "item": "1",
            "subject": "تقرير تقييم العروض الدولي المتعلق بشراء أدوية للمستشفيات بعنوان سنة 2018 ",
            "hour": "10:00"
        },
        {
            "ach": "الصيدلية المركزية التونسية",
            "item": "2",
            "subject": "تقرير تقييم العروض الدولي المتعلق بشراء أدوية للمستشفيات بعنوان سنة 2018 ",
            "hour": "10:30"
        },
        {
            "ach": "الصيدلية المركزية التونسية",
            "item": "3",
            "subject": "تقرير تقييم العروض الدولي المتعلق بشراء أدوية للمستشفيات بعنوان سنة 2018 ",
            "hour": "11:00"
        }],
        "comm": "اللجنة المختصة لمراقبة وتدقيق صفقات المواد الأولية والمواد التي يعاد بيعها على حالها",
        "num": "01/2018",
        "date": "الإثنين 23 جانفي 2018",
        "rapp": "لطيفة الطرشي"
    };

    var data1 = {

        "pdg0": "السيد الرئيس المدير العام",
        "pdg1": "للصيدلية المركزية التونسية",
        "day": "2018/01/23",
        "date": "الإثنين 23 جانفي 2018",
        "hour": "10:00",
        "subject": "تقرير تقييم العروض الدولي المتعلق بشراء أدوية للمستشفيات بعنوان سنة 2018 (117/2017)"
    };

    var data2 = {

        "name": "السيد حسّان شقير",
        "fct": "وزارة الطاقة والمناجم والطاقات المتجددة",
        "day": "2018/01/23",
        "date": "الإثنين 23 جانفي 2018",
        "hour": "10:00",
        "subject": "اجتماع اللجنة المختصة لمراقبة وتدقيق صفقات المواد الأولية والمواد التي يعاد بيعها على حالها"
    };

    function loadFile(url, callback) {
        JSZipUtils.getBinaryContent(url, callback);
    }

    function Generate(template, output, data) {
        loadFile(template, function (error, content) {
            if (error) { throw error };
            var zip = new JSZip(content);
            var doc = new Docxtemplater().loadZip(zip)
            doc.setData(data);
            try {
                doc.render()
            }
            catch (error) {
                var e = {
                    message: error.message,
                    name: error.name,
                    stack: error.stack,
                    properties: error.properties,
                }
                console.log(JSON.stringify({ error: e }));
                throw error;
            }

            var out = doc.getZip().generate({
                type: "blob",
                mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
            })
            saveAs(out, output)
        })

    }

    //Generate("/template/invmp1.docx", "invmp1.docx", data2);
    
</script>
